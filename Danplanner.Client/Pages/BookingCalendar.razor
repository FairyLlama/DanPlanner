@page "/bookingcalendar"
@rendermode InteractiveServer
@using System.Runtime.CompilerServices
@using Danplanner.Shared.Models
@inject IBookingService BookingService

<div class="d-flex justify-content-center">
    <label class="with-margin">
        Start dato<br/>
        <InputDate @bind-Value="@startDate" />
    </label>
    <label class="with-margin">
        Slut dato<br/>
        <InputDate @bind-Value="@endDate" />
    </label>
</div>

<div class="content-grid">
    @if (startDate != null)
    {
        <p class="right-aligned with-margin">Ophold fra @(ChangeDate(startDate))</p>
    }
    @if (endDate != null)
    {
        <p class="with-margin">til @(ChangeDate(endDate))</p>
    }
</div>

<div class="right-btn">
    @if (startDate != null && endDate != null)
    {
        <NavLink href="/bookingmap">
            <button class="btn btn-primary">N&#230;ste &#x21FE;</button>
        </NavLink>
    }
</div>

<body>
	<h3><b>V&#230;lg den plads du &#248;nsker at booke</b></h3>

	<div class="form-group mb-3">
		<label class="form-label">V&#230;lg antal personer</label>
		<InputSelect id="AmountOfPeople" @bind-value="SelectedAmount" class="form-select">
			<option value="0" disabled="disabled" selected>-- V&#230;lg --</option>
			@foreach (var p in AmountOfPeople)
			{
				<option value="@p">@p</option>		
			}
		</InputSelect>
	</div>

	<div class="form-group mb-3">
		<label class="form-label">V&#230;lg plads</label>
		<InputSelect id="FieldNumbers" @bind-Value="SelectedFieldNumber" class="form-select">
			<option value="0" disabled="disabled" selected>-- V&#230;lg --</option>
			@foreach (var n in FilteredNumbers)
			{
				<option value="@n">@n</option>
			}
		</InputSelect>
	</div>

	<h3><b>Herunder ser du de forskellige pladsnumre</b></h3>
	<img src="../img/campingmap.png">

</body>



@code {

      private DateTime? startDate;
      private DateTime? endDate;

      private string ChangeDate(DateTime? date)
      {
          return date != null ? DateOnly.FromDateTime(date.GetValueOrDefault()).ToString() : "";
      }




	  private int SelectedAmount { get; set; }
      private int SelectedFieldNumber { get; set; }
      private IEnumerable<int> FilteredNumbers = new List<int>();
      
      
      private IEnumerable<int> AmountOfPeople = new List<int>
	  { 1, 2, 3, 4, 5 };

      private IEnumerable<int> FieldNumbers = new List<int>
	  { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 17, 18, 20, 21, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44 };	
  
        
      Dictionary<int, List<int>> FieldsByPersonCount = new Dictionary<int, List<int>>()
      {
           [1] = new List<int> {1, 2, 3},
           [2] = new List<int> {4, 5, 6},
           [3] = new List<int> {7, 8, 9},
           [4] = new List<int> {10, 11, 12},
           [5] = new List<int> {13, 14, 15},
      };
      
           
      public void AmountChanged(int value)
      {
            
         var newValue = value ?? string.Empty;

         if (FieldsByPersonCount.ContainsKey(value))
         {
              FilteredNumbers = FieldsByPersonCount[value];
         }
            
      }

}